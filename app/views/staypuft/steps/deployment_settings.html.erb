<%= render :layout => 'title' do %>
  <%= alert_if_deployed %>

  <%= form_for(@deployment, :url => wizard_path, :method => 'PUT') do |f| %>
    <%= base_errors_for @deployment %>

    <div class="wizard-container">
      <%= deployment_wizard 1 %>
    </div>

    <%= text_f f, :name %>
    <%= textarea_f f, :description, :rows => 3 %>

    <% { layout_name:   Staypuft::Deployment::LayoutName,
         networking:    Staypuft::Deployment::Networking,
         hypervisor:    Staypuft::Deployment::Hypervisor }.
           each do |attr, constants| %>

      <%= field(f, attr, :label => _(constants::HUMAN)) do
        constants::LABELS.map do |value, label|
          radio_button_f_non_inline(f, attr,
                                    :checked => value == @deployment.send(attr),
                                    :value   => value,
                                    :text    => _(label))
        end.join
      end %>
    <% end %>
    <%= hidden_field(f, :amqp_provider, :label => _(Staypuft::Deployment::AmqpProvider::HUMAN)) do
      Staypuft::Deployment::AmqpProvider::LABELS.map do |value, label|
        radio_button_f_non_inline(f, :amqp_provider,
                                  :checked => value == @deployment.send(attr),
                                  :value   => value,
                                  :text    => _(label))
      end.join
      end %>

    <div class="form_actions">
      <% if !is_new %>
        <%= link_to _("Cancel"), deployment_path(@deployment),
                    :class => "btn btn-danger" %>
      <% else %>
        <%= link_to _("Cancel"), deployment_path(@deployment),
                    :method  => :delete,
                    :confirm => _("This will clear whole deployment configuration. Are you sure?"),
                    :class   => "btn btn-danger" %>
      <% end %>
      <%= button_tag(:type => 'submit', :class => "btn btn-primary pull-right") do %>
        <%= _("Next") %>
        <span class="glyphicon glyphicon-chevron-right"></span>
      <% end %>
    </div>
  <% end %>
<% end %>
